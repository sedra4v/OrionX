<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Rain</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    /* === Reset === */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      width: 100%;
      font-family: Arial, sans-serif;
      color: #fff;
    }

    /* === Background === */
    .page-background {
      position: relative;
      width: 100%;
      height: 100vh;
    }
    .bg-video {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      z-index: -1;
    }

    /* === Layout === */
    .container {
      display: flex;
      justify-content: space-between;
      align-items: stretch;
      height: 100vh;
      padding: 16px;
      gap: 16px;
    }

    /* === Navbar === */
    .navbar {
      background: rgba(135,132,132,0.2);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.3);
      border-radius: 12px;
      padding: 12px;
      width: 24%;
      min-width: 250px;
      transition: all .4s ease;
      overflow: auto;
    }
    .collapsed .navbar {
      width: 0;
      min-width: 0;
      padding: 0;
      border: none;
    }
    .collapsed .content {
      width: 100%;
    }

    #showNavBtn {
      display: none;
      position: fixed;
      top: 10px;
      left: 10px;
      padding: 8px 12px;
      cursor: pointer;
      border-radius: 8px;
      border: none;
      background: rgba(255,255,255,.2);
      backdrop-filter: blur(5px);
      color: #fff;
      z-index: 10;
    }
    .collapsed #showNavBtn {
      display: block;
    }

    .header {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 12px;
    }
    button {
      padding: 8px 12px;
      margin-bottom: 10px;
      cursor: pointer;
      border-radius: 8px;
      border: none;
      background: rgba(255,255,255,.2);
      backdrop-filter: blur(5px);
      color: #fff;
    }

    .search {
      display: flex;
      gap: 8px;
      width: 100%;
    }
    #search {
      flex: 1;
      height: 38px;
      background: #fff;
      border-radius: 30px;
      padding: 0 14px;
      border: none;
      color: #000;
    }

    .cards {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    /* === City Card === */
    .daywealther {
      background-color: rgba(216,226,235,0.8);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.3);
      border-radius: 12px;
      padding: 12px 16px;
      width: 100%;
      transition: .25s ease;
      display: flex;
      justify-content: space-between;
      align-items: center;
      color: #000;
      cursor: pointer;
    }
    .daywealther:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(0,0,0,.18);
    }
    .title {
      width: 70%;
    }
    .title h2 {
      font-size: 18px;
      margin-bottom: 4px;
    }
    .title p {
      font-size: 13px;
      opacity: .85;
    }
    .number {
      font-size: 28px;
      font-weight: 700;
    }

    /* === Content Area === */
    .content {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 16px;
      background: rgba(255,255,255,0.1);
      border-radius: 12px;
      padding: 16px;
      position: relative;
    }

    .topbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
    }
    .city-badge {
      font-weight: 600;
      font-size: 18px;
      opacity: .95;
    }
    .summary {
      opacity: .9;
    }

    /* === Stats Box === */

.weather-stats {
      flex: 2;
      background: rgba(0,0,0,.4);
      border-radius: 12px;
      padding: 20px;
      backdrop-filter: blur(8px);
    }
    .weather-stats h2 {
      margin-bottom: 10px;
      text-align: center;
    }
    .charts {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
    }
    .chart-box {
      flex: 1;
      min-width: 300px;
      background: rgba(255,255,255,.1);
      padding: 20px;
      border-radius: 12px;
      backdrop-filter: blur(8px);
    }

    /* === Tips Box === */
    .side-box {
      flex: 1;
      background: rgba(255,255,255,.05);
      border-radius: 12px;
      backdrop-filter: blur(8px);
      padding: 20px;
    }
    .tips-list {
      margin-top: 10px;
      line-height: 1.6;
    }
    .tips-list li {
      margin-left: 16px;
    }
    .skycue{
      width:100%;
        margin: 10px;
        color: #000;
        text-align: center;
    }

    .cardss{
      display: flex;
      justify-content: space-between;
      gap:10px;
      justify-content: center;
      align-items: center;
     

    }
    .card1{
       text-align: center;
       height: 100px;
       width: 60%;
       background-color: rgba(228, 225, 218, 0.269);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid rgba(226, 221, 221, 0.226);
      border-radius: 12px;
      transition: .25s ease;
      cursor: pointer;
       
    }
    .card1 span {
  font-size:14px;
  margin-top:6px;
  color:#333;
}

    .skycue img{
      width:200px;
      height: 250px;
    }
  </style>
</head>
<body>
  <div class="page-background">
    <video autoplay muted loop class="bg-video">
      <source src="video/RainVid.mp4" type="video/mp4"/>
      Your browser does not support HTML5 video.
    </video>

    <div class="container" id="mainContainer">
      <div class="navbar">
        <div class="header">
          <button id="hideNavBtn">Hide Nav</button>
          <h1>Weather</h1>
        </div>
        <div class="search">
          <input type="text" id="search" placeholder="Search city (e.g., Amman, Zarqa, Irbid, Aqaba)"/>
          <button id="searchBtn">Go</button>
        </div>

        <!-- Cards container -->
        <div class="cards" id="cardsContainer"></div>
      </div>

      <div class="content">
        <button id="showNavBtn">Show Nav</button>

        <div class="topbar">
          <div class="city-badge" id="cityBadge">Select a city</div>
          <div class="summary" id="citySummary">Choose a city from the left or search by name.</div>
        </div>


         <div class="side-box" id="tipsBox">
          <h3>Traveler Tips</h3>
          <p>Tips will appear here after you pick a city.</p>
          <ul class="tips-list" id="tipsList"></ul>
        </div>

        
        <div class="weather-stats">
          <h2>Weather Statistics</h2>
          <div class="charts">
            <div class="chart-box">
              <canvas id="doughnutChart"></canvas>
            </div>
            <div class="chart-box">
              <canvas id="lineChart"></canvas>
               <div class="skycue">
               
<div class="cardss">
  <div class="card1"><div id="dayTemp"></div><span id="dayAlert"></span></div>
  <div class="card1"><div id="nightTemp"></div><span id="nightAlert"></span></div>
  <div class="card1"><div id="windSpeed"></div><span id="windAlert"></span></div>
  <div class="card1"><div id="humidity"></div><span id="humidityAlert"></span></div>
</div>
            </div>
           
            </div>
          </div>
        </div>

       
      </div>
    </div>
  </div>

  <script>
    // 1) بيانات المدن
    const weatherData = {
      "Amman": [
        {"date":"2025-09-17","precip_mm_day":0.01,"humidity_pct":55.0,"wind_speed_ms":3.2,"temp_day_max_c":32.2,"temp_night_min_c":16.7},


{"date":"2025-09-18","precip_mm_day":0.0,"humidity_pct":57.5,"wind_speed_ms":3.9,"temp_day_max_c":32.6,"temp_night_min_c":16.0},
        {"date":"2025-09-19","precip_mm_day":0.09,"humidity_pct":59.1,"wind_speed_ms":4.0,"temp_day_max_c":31.2,"temp_night_min_c":19.6},
        {"date":"2025-09-20","precip_mm_day":0.0,"humidity_pct":39.5,"wind_speed_ms":2.2,"temp_day_max_c":32.6,"temp_night_min_c":16.8},
        {"date":"2025-09-21","precip_mm_day":0.0,"humidity_pct":23.2,"wind_speed_ms":2.6,"temp_day_max_c":34.0,"temp_night_min_c":17.6},
        {"date":"2025-09-22","precip_mm_day":0.0,"humidity_pct":22.4,"wind_speed_ms":3.0,"temp_day_max_c":34.3,"temp_night_min_c":18.6},
        {"date":"2025-09-23","precip_mm_day":0.0,"humidity_pct":19.7,"wind_speed_ms":2.6,"temp_day_max_c":35.1,"temp_night_min_c":18.7}
      ],
      "Zarqa": [
        {"date":"2025-09-17","precip_mm_day":0.0,"humidity_pct":57.9,"wind_speed_ms":3.6,"temp_day_max_c":33.3,"temp_night_min_c":18.3},
        {"date":"2025-09-18","precip_mm_day":0.0,"humidity_pct":57.5,"wind_speed_ms":3.95,"temp_day_max_c":32.63,"temp_night_min_c":16.03},
        {"date":"2025-09-19","precip_mm_day":0.09,"humidity_pct":59.1,"wind_speed_ms":4.0,"temp_day_max_c":31.21,"temp_night_min_c":19.61},
        {"date":"2025-09-20","precip_mm_day":0.0,"humidity_pct":39.48,"wind_speed_ms":2.21,"temp_day_max_c":32.64,"temp_night_min_c":16.78},
        {"date":"2025-09-21","precip_mm_day":0.0,"humidity_pct":23.21,"wind_speed_ms":2.61,"temp_day_max_c":33.96,"temp_night_min_c":17.58},
        {"date":"2025-09-22","precip_mm_day":0.0,"humidity_pct":22.42,"wind_speed_ms":3.01,"temp_day_max_c":34.33,"temp_night_min_c":18.64},
        {"date":"2025-09-23","precip_mm_day":0.0,"humidity_pct":19.65,"wind_speed_ms":2.61,"temp_day_max_c":35.07,"temp_night_min_c":18.68}
      ],
      "Irbid": [
        {"date":"2025-09-17","precip_mm_day":0.0,"humidity_pct":60.64,"wind_speed_ms":2.49,"temp_day_max_c":36.04,"temp_night_min_c":21.78},
        {"date":"2025-09-18","precip_mm_day":0.0,"humidity_pct":62.01,"wind_speed_ms":2.81,"temp_day_max_c":35.0,"temp_night_min_c":19.84},
        {"date":"2025-09-19","precip_mm_day":0.04,"humidity_pct":58.43,"wind_speed_ms":2.69,"temp_day_max_c":34.72,"temp_night_min_c":22.18},
        {"date":"2025-09-20","precip_mm_day":0.0,"humidity_pct":41.48,"wind_speed_ms":2.09,"temp_day_max_c":36.11,"temp_night_min_c":19.73},
        {"date":"2025-09-21","precip_mm_day":0.0,"humidity_pct":29.91,"wind_speed_ms":2.18,"temp_day_max_c":38.16,"temp_night_min_c":19.84},
        {"date":"2025-09-22","precip_mm_day":0.0,"humidity_pct":31.73,"wind_speed_ms":2.48,"temp_day_max_c":38.33,"temp_night_min_c":20.84},
        {"date":"2025-09-23","precip_mm_day":0.0,"humidity_pct":37.82,"wind_speed_ms":2.33,"temp_day_max_c":38.31,"temp_night_min_c":21.06}
      ],
      "Aqaba": [
        {"date":"2025-09-17","precip_mm_day":0.0,"humidity_pct":44.79,"wind_speed_ms":2.45,"temp_day_max_c":33.25,"temp_night_min_c":19.91},
        {"date":"2025-09-18","precip_mm_day":0.0,"humidity_pct":35.8,"wind_speed_ms":2.27,"temp_day_max_c":34.22,"temp_night_min_c":21.32},
        {"date":"2025-09-19","precip_mm_day":0.0,"humidity_pct":45.45,"wind_speed_ms":2.9,"temp_day_max_c":32.64,"temp_night_min_c":20.1},
        {"date":"2025-09-20","precip_mm_day":0.0,"humidity_pct":46.83,"wind_speed_ms":2.99,"temp_day_max_c":33.82,"temp_night_min_c":18.99},
        {"date":"2025-09-21","precip_mm_day":0.0,"humidity_pct":49.08,"wind_speed_ms":2.79,"temp_day_max_c":32.86,"temp_night_min_c":18.41},
        {"date":"2025-09-22","precip_mm_day":0.0,"humidity_pct":49.0,"wind_speed_ms":2.33,"temp_day_max_c":33.41,"temp_night_min_c":18.66},
        {"date":"2025-09-23","precip_mm_day":0.0,"humidity_pct":47.15,"wind_speed_ms":2.12,"temp_day_max_c":33.91,"temp_night_min_c":19.51}
      ]
    };


// 2) عناصر DOM
    const container = document.getElementById("mainContainer");
    const hideBtn = document.getElementById("hideNavBtn");
    const showBtn = document.getElementById("showNavBtn");
    const cardsContainer = document.getElementById("cardsContainer");
    const searchInput = document.getElementById("search");
    const searchBtn = document.getElementById("searchBtn");
    const cityBadge = document.getElementById("cityBadge");
    const citySummary = document.getElementById("citySummary");
    const tipsList = document.getElementById("tipsList");
    const tipsBox = document.getElementById("tipsBox");

    // 3) إظهار/إخفاء الـ Navbar
    hideBtn.addEventListener("click",()=>container.classList.add("collapsed"));
    showBtn.addEventListener("click",()=>container.classList.remove("collapsed"));

    // 4) أدوات مساعدة
    const parseDate = d => new Date(d+"T00:00:00");
    function getLatestDay(arr){
      return arr.reduce((a,b)=> parseDate(a.date)>parseDate(b.date)?a:b);
    }
    function computeSeries(city){
      const entries = weatherData[city] || [];
      const labels = entries.map(e=>e.date);
      const temps  = entries.map(e=>e.temp_day_max_c);
      const wetDays = entries.filter(e=>e.precip_mm_day>0).length;
      const dryDays = entries.length - wetDays;
      const avgHum  = entries.reduce((s,e)=>s+e.humidity_pct,0)/(entries.length||1);
      const avgWind = entries.reduce((s,e)=>s+e.wind_speed_ms,0)/(entries.length||1);
      return {labels, temps, wetDays, dryDays, avgHum, avgWind, entries};
    }
    function buildTipsFromDay(day){
      const tips = [];
      // Temperature
      if(day.temp_day_max_c > 32){
        tips.push("It's very hot today. Wear light clothes and drink enough water.");
      } else if(day.temp_day_max_c < 20){
        tips.push("It's quite cold. Wear warm clothes and consider layers.");
      } else {
        tips.push("The weather is moderate. Light, comfortable clothing is fine.");
      }
      // Humidity
      if(day.humidity_pct > 60){
        tips.push("Humidity is high. Prefer breathable fabrics and stay in shaded/cool areas.");
      } else if(day.humidity_pct < 25){
        tips.push("Air is dry. Use moisturizer and stay hydrated.");
      } else {
        tips.push("Humidity levels are comfortable for most activities.");
      }
      // Wind
      if(day.wind_speed_ms > 5){
        tips.push("Winds are strong. Secure hats and be cautious near open areas.");
      } else {
        tips.push("Winds are calm to moderate—great for outdoor plans.");
      }
      // Rain
      if(day.precip_mm_day > 0){
        tips.push("Rain is expected. Carry an umbrella or a light rain jacket.");
      } else {
        tips.push("No rain expected today.");
      }
      return tips;
    }

    // 5) بناء الكروت ديناميكيًا
    function renderCards(filterText=""){
      cardsContainer.innerHTML = "";
      const cities = Object.keys(weatherData);
      const q = filterText.trim().toLowerCase();
      cities
        .filter(c=>c.toLowerCase().includes(q))
        .forEach(city=>{
          const latest = getLatestDay(weatherData[city]);
          const card = document.createElement("div");
          card.className = "daywealther";
          card.innerHTML = `
            <div class="title">
              <h2>${city}</h2>
              <p>Last day: ${latest.date}</p>
              <p>Hum: ${latest.humidity_pct.toFixed(0)}% · Wind: ${latest.wind_speed_ms.toFixed(1)} m/s · Rain: ${latest.precip_mm_day.toFixed(2)} mm</p>
            </div>
            <div class="number">${latest.temp_day_max_c.toFixed(1)}°C</div>`
          ;
          card.addEventListener("click",()=>selectCity(city));
          cardsContainer.appendChild(card);
        });
      if(cardsContainer.children.length===0){
        const empty = document.createElement("div");
        empty.style.opacity = "0.9";
        empty.textContent = "No results. Try another city name.";
        cardsContainer.appendChild(empty);
      }
    }

// 6) البحث
    function doSearch(){
      const q = searchInput.value;
      // فلترة الكروت
      renderCards(q);
      // إذا في مدينة مطابقة بالكامل، افتحها
      const cities = Object.keys(weatherData);
      const exact = cities.find(c => c.toLowerCase() === q.trim().toLowerCase());
      if(exact){ selectCity(exact); }
    }
    searchBtn.addEventListener("click", doSearch);
    searchInput.addEventListener("keydown", (e)=>{ if(e.key==="Enter") doSearch(); });
    searchInput.addEventListener("input", ()=>renderCards(searchInput.value));

    // 7) الرسوم البيانية (نحتفظ بمراجع لتحديثها/تدميرها)
    let doughnutChartRef = null;
    let lineChartRef = null;

    function renderCharts(city){
      const {labels, temps, wetDays, dryDays} = computeSeries(city);
      // Destroy if exist
      if(doughnutChartRef){ doughnutChartRef.destroy(); }
      if(lineChartRef){ lineChartRef.destroy(); }

      // Doughnut: Wet vs Dry
      const ctxD = document.getElementById("doughnutChart").getContext("2d");
      doughnutChartRef = new Chart(ctxD,{
        type:"doughnut",
        data:{
          labels:["Dry days","Rainy days"],
          datasets:[{
            data:[dryDays, wetDays],
            backgroundColor:["#36A2EB","#4BC0C0"],
            borderColor:["#fff","#fff"],
            borderWidth:2
          }]
        },
        options:{
          plugins:{ legend:{ position:"bottom", labels:{ color:"#fff"} } }
        }
      });

      // Line: Max temp per day
      const ctxL = document.getElementById("lineChart").getContext("2d");
      lineChartRef = new Chart(ctxL,{
        type:"line",
        data:{
          labels,
          datasets:[{
            label: `Max Temp (°C) — ${city}`,
            data:temps,
            borderColor:"#FF6384",
            backgroundColor:"rgba(255,99,132,0.2)",
            fill:true,
            tension:0.35
          }]
        },
        options:{
          plugins:{ legend:{ labels:{ color:"#fff"} } },
          scales:{
            x:{ ticks:{ color:"#fff"} },
            y:{ ticks:{ color:"#fff"} }
          }
        }
      });
    }

    // 8) تحديث الملخص والنصائح
    function updateSummaryAndTips(city){
      const {avgHum, avgWind, entries} = computeSeries(city);
      const latest = getLatestDay(entries);
      cityBadge.textContent = city;
      citySummary.textContent = `Latest: ${latest.date} • Max ${latest.temp_day_max_c.toFixed(1)}°C • Hum ${latest.humidity_pct.toFixed(0)}% • Wind ${latest.wind_speed_ms.toFixed(1)} m/s`;

      const tips = buildTipsFromDay(latest);
      tipsList.innerHTML = "";
      tipsBox.querySelector("p")?.remove();
      tips.forEach(t=>{
        const li = document.createElement("li");
        li.textContent = t;
        tipsList.appendChild(li);
      });
    }

    // 9) اختيار مدينة
    function selectCity(city){
      if(!weatherData[city]) return;
      renderCharts(city);
      updateSummaryAndTips(city);
      updateCards(city);
    }

    // 10) تهيئة أولية
    (function init(){
      renderCards();      // اعرض كل الكروت
      selectCity("Amman"); // مدينة افتراضية
    })();








function updateCards(city){
  const latest = getLatestDay(weatherData[city]);
  if(!latest) return;

  // القيم
  document.getElementById("dayTemp").textContent = `Day: ${latest.temp_day_max_c}°C`;
  document.getElementById("nightTemp").textContent = `Night: ${latest.temp_night_min_c}°C`;
  document.getElementById("windSpeed").textContent = `Wind: ${latest.wind_speed_ms} m/s`;
  document.getElementById("humidity").textContent = `Humidity: ${latest.humidity_pct}%`;

  // التنبيهات
document.getElementById("dayAlert").textContent = 
  latest.temp_day_max_c > 32 ? "High temperature" : 
  (latest.temp_day_max_c < 15 ? "Cold" : "Normal");

document.getElementById("nightAlert").textContent = 
  latest.temp_night_min_c < 15 ? "Cold at night" : "Normal";

document.getElementById("windAlert").textContent = 
  latest.wind_speed_ms > 5 ? "Strong wind" : "Normal";


document.getElementById("humidityAlert").textContent = 
  latest.humidity_pct > 60 ? "High humidity" : 
  (latest.humidity_pct < 25 ? "Dry air" : "Normal");
}

  </script>
</body>
</html>
